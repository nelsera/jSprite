!function(a){function b(b,e){this.element=b,this.$el=a(this.element),this.options=a.extend({},d,e),this._defaults=d,this._name=c,this.init()}var c="jSprite",d={columns:0,lines:0,width:0,height:0,total:0,timeTransition:50,timeReload:!0};b.prototype={getSize:function(){var a=this.options.width?this.options.width:this.$el.innerWidth(),b=this.options.height?this.options.height:this.$el.innerHeight();return{width:a,height:b}},getGrid:function(a){var b=new Image,c=this;return a=a||function(){},b.onload=function(){var d=c.options.columns?c.options.columns:Math.round(b.width/c.options.width),e=c.options.lines?c.options.lines:Math.round(b.height/c.options.height);a({columns:d,lines:e})},b.src=this.$el.css("backgroundImage").replace(/url\((['"])?(.*?)\1\)/gi,"$2"),a},goTo:function(a){var b=0,c=0,d=0,e=0;return this.sprite.position=a,this.options.columns>1&&this.options.lines>1&&(b=Math.floor(this.sprite.position/this.options.columns),c=this.sprite.position%this.options.columns,e=c*this.options.width,d=b*this.options.height),1===this.options.columns&&(d=this.sprite.position*this.options.height),1===this.options.lines&&(e=this.sprite.position*this.options.width),this.$el.css({"background-position":"-"+e+"px -"+d+"px"}),this},next:function(){return this.goTo(this.sprite.position+1),this.sprite.transitionTimeout=setTimeout(function(a){a.animation()},this.options.timeTransition,this),this},restart:function(){var a=this.options.timeReload===!0?this.options.timeTransition:this.options.timeReload;return this.$el.css({"background-position":"0 0"}),this.sprite.reloadTimeout=setTimeout(function(a){a.sprite.position=0,a.animation()},a,this),this},stop:function(){return clearTimeout(this.sprite.transitionTimeout),clearTimeout(this.sprite.reloadTimeout),this},"continue":function(){return this.animation(),this},isLastFrame:function(){return this.sprite.position<this.options.total-1?!1:!0},animation:function(){return this.stop(),this.isLastFrame()?(this.options.onComplete&&this.options.onComplete(),this.options.timeReload!==!1&&this.restart()):this.next(),this},init:function(){function b(){c.options.total||(c.options.total=c.options.columns*c.options.lines),c.animation()}var c=this;this.sprite={position:0,reloadTimeout:0,transitionTimeout:0},this.options.width&&this.options.height||(this.options=a.extend({},this.options,this.getSize(c.options))),this.options.columns&&this.options.lines?b():this.getGrid(function(d){c.options=a.extend({},c.options,d),b()})}},a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})}}(jQuery,window,document);